{% extends "management/base.html" %}

{% block content %}

<div class="content-wrapper" style="display: flex;">

  <!-- Sidebar -->
  <aside class="sidebar" style="width: 350px; padding: 5rem; background-color: #f9f9f9;">
    <h2>Categories</h2>
    <ul style="list-style: none; padding-left: 0;">
      <li style="margin-bottom: 0.5rem;">
        <a href="{% url 'menu' %}"
           style="text-decoration: none; color: {% if not active_category_id %}var(--primary-color){% else %}#333{% endif %};">
          All Items
        </a>
      </li>
      {% for category in categories %}
        <li style="margin-bottom: 0.5rem;">
          <a href="{% url 'menu_category' category.id %}"
             style="text-decoration: none; color: {% if category.id == active_category_id %}var(--primary-color){% else %}#333{% endif %};">
            {{ category.name }}
          </a>
        </li>
      {% endfor %}
    </ul>
  </aside>

  <!-- Menu Section -->
  <section class="menu-section" style="flex: 1; padding: 2rem;">
    <div class="container">
      <h1 style="text-align: center; margin-bottom: 2rem;">Our Menu</h1>

      {% if menu_items %}
        <div class="menu-items" style="display: flex; flex-wrap: wrap; gap: 1.5rem; justify-content: center;">
          {% for item in menu_items %}
            <div class="menu-item" style="border: 1px solid #ccc; padding: 1rem; border-radius: 8px; width: 300px; text-align: center;">
              <h2>
                <a href="{% url 'menu_detail' menu_id=item.id %}" style="color: var(--primary-color); text-decoration: none;">
                  {{ item.name }}
                </a>
              </h2>
              {% if item.image %}
                <img src="{{ item.image.url }}" alt="{{ item.name }}" style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 1rem;">
              {% else %}
                <img src="/media/menu_images/default.jpg" alt="Default Image" style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 1rem;">
              {% endif %}
              <p><strong>Price:</strong> â‚¹{{ item.price }}</p>
              <p><strong>Unit:</strong> {{ item.unit }}</p>
              {% if item.description %}
                <p>{{ item.description }}</p>
              {% endif %}
              {% if item.discount %}
                <p><strong>Discount:</strong> {{ item.discount }}%</p>
              {% endif %}
              {% if item.inventory %}
                <p><strong>Quantity:</strong> {{ item.inventory.quantity }}</p>
                <p><strong>Expiry Date:</strong> {{ item.inventory.expiry_date }}</p>
                {% endif %}
                <div style="margin-top: 2rem;">
                <!-- Button to add item to cart -->
                <form action="{% url 'add_to_cart' menu_id=item.id %}" method="post" style="display: inline-block;">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-primary">Add to Cart</button>
                </form>
                
                <!-- Button to order immediately (redirects to checkout) -->
                <form action="{% url 'order_now' menu_id=item.id %}" method="post" style="display: inline-block; margin-left: 1rem;">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-success">Order Now</button>
                </form>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p style="text-align: center;">No items available{% if active_category_name %} in {{ active_category_name }}{% endif %}.</p>
      {% endif %}
    </div>
  </section>

</div>

{% endblock %}
